```{julia}
using Ipaper, SpatRasters #, ArchGDAL
using NetCDFTools, Test
using MakieLayers, CairoMakie

indir = "$(@__DIR__)/../../../data" |> abspath
```

```{julia}
# using RTableTools
# st = fread("data/st_met2481.csv")
# serialize("data/st_met2481", st[:, [:site, :lon, :lat, :alt]])
st = deserialize("$indir/st_met2481")
sites = [st.lon st.lat]
alt = st[:, :alt]
data = repeat(alt, 1, 24)' |> collect
```

```{julia}
b = bbox(70, 15, 140, 55)
lon, lat = bbox2dims(b; cellsize=0.5)
nlon, nlat = length(lon), length(lat)
ra = rast(rand(nlon, nlat), b)
```

```{julia}
weights = weights_idw(ra, sites)
@test length(rm_empty(weights[:])) == 7861

weights = weights_idw(ra, sites)
weights = weights_adw(ra, sites)
@time zs = spInterp(weights, data)

@test size(zs) == (nlon, nlat, 24)
@test mean(zs[:, :, 1]) â‰ˆ 814.0711051650405
```

```{julia}
imagesc(zs[:, :, 1])
```
